@page
@model Mo.PersonalWebsite.Pages.Admin.Pages.IndexModel
@{
    ViewData["Title"] = "Manage Pages";
}

<section class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1 class="h3 mb-1">Manage Pages</h1>
                <p class="text-secondary mb-0">Manage dynamic website pages</p>
            </div>
            <div class="d-flex gap-2">
                <a href="/Admin/Pages/Create" class="btn btn-primary">
                    <i class="bi bi-plus-circle me-1"></i>New Page
                </a>
                <a href="/Admin/Dashboard" class="btn btn-secondary">
                    <i class="bi bi-arrow-left me-1"></i>Back to Dashboard
                </a>
            </div>
        </div>

        @if (Model.Pages.Any())
        {
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th scope="col">Page Title</th>
                                    <th scope="col">Slug</th>
                                    <th scope="col">Status</th>
                                    <th scope="col">Navigation</th>
                                    <th scope="col">Last Modified</th>
                                    <th scope="col" class="text-end">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Pages.OrderBy(p => p.Title))
                                {
                                    <tr>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <i class="bi bi-file-text text-primary me-2"></i>
                                                <strong>@item.Title</strong>
                                            </div>
                                        </td>
                                        <td>
                                            <code class="text-muted">/@item.Slug</code>
                                        </td>
                                        <td>
                                            @if (item.IsPublished)
                                            {
                                                <span class="badge bg-success">Published</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-secondary">Draft</span>
                                            }
                                        </td>
                                        <td>
                                            @if (item.ShowInNavigation)
                                            {
                                                <span class="badge bg-info">In Nav</span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">-</span>
                                            }
                                        </td>
                                        <td>
                                            <small class="text-muted">@item.UpdatedAt.ToString("MMM dd, yyyy HH:mm")</small>
                                        </td>
                                        <td class="text-end">
                                            <div class="btn-group btn-group-sm">
                                                <a href="/Pages/@item.Slug" target="_blank" class="btn btn-outline-primary" title="View Page">
                                                    <i class="bi bi-eye"></i>
                                                </a>
                                                <a href="/Admin/Pages/Edit/@item.Id" class="btn btn-outline-secondary" title="Edit Page">
                                                    <i class="bi bi-pencil"></i>
                                                </a>
                                                <form method="post" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this page?')">
                                                    @Html.AntiForgeryToken()
                                                    <input type="hidden" name="id" value="@item.Id" />
                                                    <button type="submit" asp-page-handler="Delete" class="btn btn-outline-danger" title="Delete Page">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="card shadow-sm">
                <div class="card-body text-center py-5">
                    <i class="bi bi-file-text text-muted mb-3" style="font-size: 3rem;"></i>
                    <h5 class="text-muted">No Pages Found</h5>
                    <p class="text-muted mb-0">No static pages were found in the Pages directory.</p>
                </div>
            </div>
        }

        <!-- Information Card -->
        <div class="card shadow-sm mt-4 border-info">
            <div class="card-body">
                <div class="d-flex align-items-start">
                    <i class="bi bi-info-circle text-info me-2 mt-1"></i>
                    <div>
                        <h6 class="mb-2">About Page Management</h6>
                        <p class="small text-muted mb-0">
                            This page allows you to create and manage dynamic pages stored in the database. 
                            You can control their content, SEO settings, publication status, and navigation visibility.
                            Pages can be accessed at /Pages/{slug} or added to the main navigation.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
